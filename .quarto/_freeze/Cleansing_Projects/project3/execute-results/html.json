{
  "hash": "cb980b2e5cc0591d498a8e837049b2dd",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Client Report - [Insert Project Title]\"\nsubtitle: \"Course DS 250\"\nauthor: \"[Tanner Hamblin]\"\nformat:\n  html:\n    self-contained: true\n    page-layout: full\n    title-block-banner: true\n    toc: true\n    toc-depth: 3\n    toc-location: body\n    number-sections: false\n    html-math-method: katex\n    code-fold: true\n    code-summary: \"Show the code\"\n    code-overflow: wrap\n    code-copy: hover\n    code-tools:\n        source: false\n        toggle: true\n        caption: See code\nexecute: \n  warning: false\n    \n---\n\n::: {#78d69795 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nfrom lets_plot import *\n\nLetsPlot.setup_html(isolated_frame=True)\n```\n:::\n\n\n::: {#5a9636fe .cell execution_count=2}\n``` {.python .cell-code}\n# Learn morea about Code Cells: https://quarto.org/docs/reference/cells/cells-jupyter.html\n\n# Include and execute your code here\ndf = pd.read_json(\"https://github.com/byuidatascience/data4missing/raw/master/data-raw/flights_missing/flights_missing.json\")\n```\n:::\n\n\n## Elevator pitch\n_A SHORT (2-3 SENTENCES) PARAGRAPH THAT `DESCRIBES KEY INSIGHTS` TAKEN FROM METRICS IN THE PROJECT RESULTS THINK TOP OR MOST IMPORTANT RESULTS._ (Note: this is not a summary of the project, but a summary of the results.)\n\nThe following graphs show that the best month to fly is december to avoid delays is september. The most common type of delay you are likley to encounter is weather delays. The airport out of the list with the lowest average delay is SAN with a delay of .79 hours. The worst is Orlando with an average delay of 1.13 hours.\n\n## QUESTION|TASK 1\n\n__Fix all of the varied missing data types in the data to be consistent (all missing values should be displayed as “NaN”).__ In your report include one record example (one row) from your new data, in the raw JSON format. Your example should display the \"NaN\" for at least one missing value.__  \n\n_type your results and analysis here_\n\nDropped any outliers or missing data replacing them with the value NAN\n\n::: {#aebb41c9 .cell execution_count=3}\n``` {.python .cell-code}\ndf.num_of_delays_late_aircraft.replace(-999,np.nan,inplace = True) \ndf.num_of_delays_carrier.replace(\"1500+\",1500,inplace = True) \ndf.airport_name.replace(\"\",np.nan,inplace = True) \ndf.month.replace(\"n/a\",np.nan,inplace = True) \ndf.minutes_delayed_nas.replace(-999.0,np.nan,inplace = True) \ndf.num_of_delays_late_aircraft.value_counts(dropna=False)\ndf['num_of_delays_carrier'] = df['num_of_delays_carrier'].astype(int)\ndf.month.replace(\"Febuary\",\"February\",inplace = True)\nmonth_order = [\"January\", \"February\", \"March\", \"April\",\n          \"May\", \"June\", \"July\", \"August\",\n          \"September\", \"October\", \"November\", \"December\"] \ndf['month'] = pd.Categorical(df['month'],categories=month_order, ordered=True)\n\ndf.head(1) \n\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>airport_code</th>\n      <th>airport_name</th>\n      <th>month</th>\n      <th>year</th>\n      <th>num_of_flights_total</th>\n      <th>num_of_delays_carrier</th>\n      <th>num_of_delays_late_aircraft</th>\n      <th>num_of_delays_nas</th>\n      <th>num_of_delays_security</th>\n      <th>num_of_delays_weather</th>\n      <th>num_of_delays_total</th>\n      <th>minutes_delayed_carrier</th>\n      <th>minutes_delayed_late_aircraft</th>\n      <th>minutes_delayed_nas</th>\n      <th>minutes_delayed_security</th>\n      <th>minutes_delayed_weather</th>\n      <th>minutes_delayed_total</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>ATL</td>\n      <td>Atlanta, GA: Hartsfield-Jackson Atlanta Intern...</td>\n      <td>January</td>\n      <td>2005.0</td>\n      <td>35048</td>\n      <td>1500</td>\n      <td>NaN</td>\n      <td>4598</td>\n      <td>10</td>\n      <td>448</td>\n      <td>8355</td>\n      <td>116423.0</td>\n      <td>104415</td>\n      <td>207467.0</td>\n      <td>297</td>\n      <td>36931</td>\n      <td>465533</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## QUESTION|TASK 2\n\n__Which airport has the worst delays?__ Describe the metric you chose, and why you chose it to determine the “worst” airport. Your answer should include a summary table that lists (for each airport) the total number of flights, total number of delayed flights, proportion of delayed flights, and average delay time in hours.   \n\nI used the metric of sorting the flights by airport and using a metric I found the total flights per airport as well as the total delayed flights by airports. using these I found the proportion of delay time per flight. SFO sanfrancisco has the worst proportion with .261 of the flights having delays. Then I found the average delay time and we can see that Orlando has the worst average delay time of 1.13 hours.\n\n::: {#dc07ba52 .cell execution_count=4}\n``` {.python .cell-code}\ndf2 = df.groupby(\"airport_code\").agg(\n  total_flights = ('num_of_flights_total', 'sum'),\n  total_delayed_flights = ('num_of_delays_total', 'sum'),\n  sum_delay_time = ('minutes_delayed_total', 'sum')\n)\n\ndf2['sum_delay_time'] = df2['sum_delay_time'] / 60\ndf2['prop_delayed_flight'] = round(df2['total_delayed_flights'] / df2['total_flights'],3)\n\ndf2['avg_delay_time'] = round(df2['sum_delay_time'] / df2['total_delayed_flights'],2)\n\n\n\ndf2\n# df2.columns\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>total_flights</th>\n      <th>total_delayed_flights</th>\n      <th>sum_delay_time</th>\n      <th>prop_delayed_flight</th>\n      <th>avg_delay_time</th>\n    </tr>\n    <tr>\n      <th>airport_code</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>ATL</th>\n      <td>4430047</td>\n      <td>902443</td>\n      <td>899732.100000</td>\n      <td>0.204</td>\n      <td>1.00</td>\n    </tr>\n    <tr>\n      <th>DEN</th>\n      <td>2513974</td>\n      <td>468519</td>\n      <td>419556.350000</td>\n      <td>0.186</td>\n      <td>0.90</td>\n    </tr>\n    <tr>\n      <th>IAD</th>\n      <td>851571</td>\n      <td>168467</td>\n      <td>171391.300000</td>\n      <td>0.198</td>\n      <td>1.02</td>\n    </tr>\n    <tr>\n      <th>ORD</th>\n      <td>3597588</td>\n      <td>830825</td>\n      <td>939268.816667</td>\n      <td>0.231</td>\n      <td>1.13</td>\n    </tr>\n    <tr>\n      <th>SAN</th>\n      <td>917862</td>\n      <td>175132</td>\n      <td>137937.466667</td>\n      <td>0.191</td>\n      <td>0.79</td>\n    </tr>\n    <tr>\n      <th>SFO</th>\n      <td>1630945</td>\n      <td>425604</td>\n      <td>442508.216667</td>\n      <td>0.261</td>\n      <td>1.04</td>\n    </tr>\n    <tr>\n      <th>SLC</th>\n      <td>1403384</td>\n      <td>205160</td>\n      <td>168722.850000</td>\n      <td>0.146</td>\n      <td>0.82</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## QUESTION|TASK 3\n\n__What is the best month to fly if you want to avoid delays of any length?__ Describe the metric you chose and why you chose it to calculate your answer. Include one chart to help support your answer, with the x-axis ordered by month. (To answer this question, you will need to remove any rows that are missing the `Month` variable.)  \n\nI found the proportion of flight delays and total delayed flights by each month. we find that July has the most delayed flights with 319960 in the month of july.\n\n::: {#80988bf9 .cell execution_count=5}\n``` {.python .cell-code}\ndf3 = df.groupby('month').agg(\n  total_flights = ('num_of_flights_total', 'sum'),\n  total_delayed_flights = ('num_of_delays_total', 'sum')\n).reset_index()\ndf3.month.value_counts(dropna=True)\n\ndf3['total_flight_by_delay'] = round(df3['total_delayed_flights'] / df3['total_flights'],2)\n\ndf3\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>month</th>\n      <th>total_flights</th>\n      <th>total_delayed_flights</th>\n      <th>total_flight_by_delay</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>January</td>\n      <td>1193018</td>\n      <td>265001</td>\n      <td>0.22</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>February</td>\n      <td>1115814</td>\n      <td>248033</td>\n      <td>0.22</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>March</td>\n      <td>1213370</td>\n      <td>250142</td>\n      <td>0.21</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>April</td>\n      <td>1259723</td>\n      <td>231408</td>\n      <td>0.18</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>May</td>\n      <td>1227795</td>\n      <td>233494</td>\n      <td>0.19</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>June</td>\n      <td>1305663</td>\n      <td>317895</td>\n      <td>0.24</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>July</td>\n      <td>1371741</td>\n      <td>319960</td>\n      <td>0.23</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>August</td>\n      <td>1335158</td>\n      <td>279699</td>\n      <td>0.21</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>September</td>\n      <td>1227208</td>\n      <td>201905</td>\n      <td>0.16</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>October</td>\n      <td>1301612</td>\n      <td>235166</td>\n      <td>0.18</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>November</td>\n      <td>1185434</td>\n      <td>197768</td>\n      <td>0.17</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>December</td>\n      <td>1180278</td>\n      <td>303133</td>\n      <td>0.26</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThe following graph shows us that the proportion of delays to flights showing the chances of you experiencing a delay on your flight is lowest in the month of september.\n\n::: {#08a9637d .cell execution_count=6}\n``` {.python .cell-code}\np = (ggplot(df3, aes(x='month', y='total_flight_by_delay', )) +\n  geom_bar(stat = 'identity', color = 'black', fill = 'white', width = .85) +\n  xlab('Month') +\n  ylab('% of Flights Delayed') +\n  labs(\n    title=\"Chance of Experiencing Any Delay by Month\"\n  )+\n  theme_classic() +\n  theme(\n    axis_text_y= element_text(),\n    plot_title= element_text(angle=90, size=20),\n    panel_background= element_rect(fill = \"gray\")\n  )\n\n)\np.show()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<html lang=\"en\">\n   <head>\n       <meta charset=\"UTF-8\">\n       <style> html, body { margin: 0; padding: 0; } </style>\n       <script type=\"text/javascript\" data-lets-plot-script=\"library\" src=\"https://cdn.jsdelivr.net/gh/JetBrains/lets-plot@v4.6.2/js-package/distr/lets-plot.min.js\"></script>\n   </head>\n   <body>\n          <div id=\"Ge22XE\"></div>\n   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n   \n   (function() {\n   // ----------\n   \n   const forceImmediateRender = false;\n   const responsive = false;\n   \n   let sizing = {\n       width_mode: \"MIN\",\n       height_mode: \"SCALED\",\n       width: null, \n       height: null \n   };\n   \n   const preferredWidth = document.body.dataset.letsPlotPreferredWidth;\n   if (preferredWidth !== undefined) {\n       sizing = {\n           width_mode: 'FIXED',\n           height_mode: 'SCALED',\n           width: parseFloat(preferredWidth)\n       };\n   }\n   \n   const containerDiv = document.getElementById(\"Ge22XE\");\n   let fig = null;\n   \n   function renderPlot() {\n       if (fig === null) {\n           const plotSpec = {\n\"data\":{\n\"month\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\n\"total_flight_by_delay\":[0.22,0.22,0.21,0.18,0.19,0.24,0.23,0.21,0.16,0.18,0.17,0.26]\n},\n\"mapping\":{\n\"x\":\"month\",\n\"y\":\"total_flight_by_delay\"\n},\n\"data_meta\":{\n\"series_annotations\":[{\n\"type\":\"str\",\n\"factor_levels\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\n\"column\":\"month\"\n},{\n\"type\":\"int\",\n\"column\":\"total_flights\"\n},{\n\"type\":\"int\",\n\"column\":\"total_delayed_flights\"\n},{\n\"type\":\"float\",\n\"column\":\"total_flight_by_delay\"\n}]\n},\n\"guides\":{\n\"x\":{\n\"title\":\"Month\"\n},\n\"y\":{\n\"title\":\"% of Flights Delayed\"\n}\n},\n\"ggtitle\":{\n\"text\":\"Chance of Experiencing Any Delay by Month\"\n},\n\"theme\":{\n\"name\":\"classic\",\n\"axis_text_y\":{\n\"blank\":false\n},\n\"panel_background\":{\n\"fill\":\"gray\",\n\"blank\":false\n},\n\"plot_title\":{\n\"size\":20.0,\n\"angle\":90.0,\n\"blank\":false\n}\n},\n\"kind\":\"plot\",\n\"scales\":[],\n\"layers\":[{\n\"geom\":\"bar\",\n\"stat\":\"identity\",\n\"mapping\":{\n},\n\"data_meta\":{\n\"series_annotations\":[{\n\"column\":\"month\",\n\"factor_levels\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"]\n}]\n},\n\"color\":\"black\",\n\"fill\":\"white\",\n\"width\":0.85,\n\"data\":{\n}\n}],\n\"metainfo_list\":[],\n\"spec_id\":\"1\"\n};\n           fig = LetsPlot.buildPlotFromProcessedSpecs(plotSpec, containerDiv, sizing);\n       } else {\n           fig.updateView({});\n       }\n   }\n   \n   const renderImmediately = \n       forceImmediateRender || (\n           sizing.width_mode === 'FIXED' && \n           (sizing.height_mode === 'FIXED' || sizing.height_mode === 'SCALED')\n       );\n   \n   if (renderImmediately) {\n       renderPlot();\n   }\n   \n   if (!renderImmediately || responsive) {\n       // Set up observer for initial sizing or continuous monitoring\n       var observer = new ResizeObserver(function(entries) {\n           for (let entry of entries) {\n               if (entry.contentBoxSize && \n                   entry.contentBoxSize[0].inlineSize > 0) {\n                   if (!responsive && observer) {\n                       observer.disconnect();\n                       observer = null;\n                   }\n                   renderPlot();\n                   if (!responsive) {\n                       break;\n                   }\n               }\n           }\n       });\n       \n       observer.observe(containerDiv);\n   }\n   \n   // ----------\n   })();\n   \n   </script>\n   </body>\n</html>\n```\n:::\n:::\n\n\n## QUESTION|TASK 4\n\nAccording to the BTS website, the “Weather” category only accounts for severe weather delays. Mild weather delays are not counted in the “Weather” category, but are actually included in both the “NAS” and “Late-Arriving Aircraft” categories. __Your job is to create a new column that calculates the total number of flights delayed by weather (both severe and mild).__ You will need to replace all the missing values in the Late Aircraft variable with the mean. Show your work by printing the first 5 rows of data in a table. Use these three rules for your calculations:  \n\n    a. 100% of delayed flights in the Weather category are due to weather  \n    a. 30% of all delayed flights in the Late-Arriving category are due to weather  \n    a. From April to August, 40% of delayed flights in the NAS category are due to weather. The rest of the months, the proportion rises to 65%    \n\nThe following shows the first 5 rows of airport codes. They show that the total weather delays that are not severe. we see that the orlando has the most minor weather delays.\n\n::: {#aa45f6fc .cell execution_count=7}\n``` {.python .cell-code}\ndf4 = df.copy()\ndf4['num_of_delays_late_aircraft'] = df4['num_of_delays_late_aircraft'].fillna(df4['num_of_delays_late_aircraft'].mean())\n```\n:::\n\n\n::: {#0f66c14b .cell execution_count=8}\n``` {.python .cell-code}\ndf4['total_weather_delay'] = df4['num_of_delays_late_aircraft'] + (df4['num_of_delays_late_aircraft'] * .3) + np.select(df4['month'].isin([\"April\",\n          \"May\", \"June\", \"July\", \"August\"]), df4['num_of_delays_nas'] * .4, df4['num_of_delays_nas'] * .65)\n\ndf4.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>airport_code</th>\n      <th>airport_name</th>\n      <th>month</th>\n      <th>year</th>\n      <th>num_of_flights_total</th>\n      <th>num_of_delays_carrier</th>\n      <th>num_of_delays_late_aircraft</th>\n      <th>num_of_delays_nas</th>\n      <th>num_of_delays_security</th>\n      <th>num_of_delays_weather</th>\n      <th>num_of_delays_total</th>\n      <th>minutes_delayed_carrier</th>\n      <th>minutes_delayed_late_aircraft</th>\n      <th>minutes_delayed_nas</th>\n      <th>minutes_delayed_security</th>\n      <th>minutes_delayed_weather</th>\n      <th>minutes_delayed_total</th>\n      <th>total_weather_delay</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>ATL</td>\n      <td>Atlanta, GA: Hartsfield-Jackson Atlanta Intern...</td>\n      <td>January</td>\n      <td>2005.0</td>\n      <td>35048</td>\n      <td>1500</td>\n      <td>1109.104072</td>\n      <td>4598</td>\n      <td>10</td>\n      <td>448</td>\n      <td>8355</td>\n      <td>116423.0</td>\n      <td>104415</td>\n      <td>207467.0</td>\n      <td>297</td>\n      <td>36931</td>\n      <td>465533</td>\n      <td>2535.435294</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>DEN</td>\n      <td>Denver, CO: Denver International</td>\n      <td>January</td>\n      <td>2005.0</td>\n      <td>12687</td>\n      <td>1041</td>\n      <td>928.000000</td>\n      <td>935</td>\n      <td>11</td>\n      <td>233</td>\n      <td>3153</td>\n      <td>53537.0</td>\n      <td>70301</td>\n      <td>36817.0</td>\n      <td>363</td>\n      <td>21779</td>\n      <td>182797</td>\n      <td>2300.000000</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>IAD</td>\n      <td>NaN</td>\n      <td>January</td>\n      <td>2005.0</td>\n      <td>12381</td>\n      <td>414</td>\n      <td>1058.000000</td>\n      <td>895</td>\n      <td>4</td>\n      <td>61</td>\n      <td>2430</td>\n      <td>NaN</td>\n      <td>70919</td>\n      <td>35660.0</td>\n      <td>208</td>\n      <td>4497</td>\n      <td>134881</td>\n      <td>2469.000000</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>ORD</td>\n      <td>Chicago, IL: Chicago O'Hare International</td>\n      <td>January</td>\n      <td>2005.0</td>\n      <td>28194</td>\n      <td>1197</td>\n      <td>2255.000000</td>\n      <td>5415</td>\n      <td>5</td>\n      <td>306</td>\n      <td>9178</td>\n      <td>88691.0</td>\n      <td>160811</td>\n      <td>364382.0</td>\n      <td>151</td>\n      <td>24859</td>\n      <td>638894</td>\n      <td>4025.100000</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>SAN</td>\n      <td>San Diego, CA: San Diego International</td>\n      <td>January</td>\n      <td>2005.0</td>\n      <td>7283</td>\n      <td>572</td>\n      <td>680.000000</td>\n      <td>638</td>\n      <td>7</td>\n      <td>56</td>\n      <td>1952</td>\n      <td>27436.0</td>\n      <td>38445</td>\n      <td>21127.0</td>\n      <td>218</td>\n      <td>4326</td>\n      <td>91552</td>\n      <td>1977.600000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## QUESTION|TASK 5\n\n__Using the new weather variable calculated above, create a barplot showing the proportion of all flights that are delayed by weather at each airport. Describe what you learn from this graph.__  \n\nThe following results show that your chances of encountering a delay whether it is from weather, security, or carrier all being factored in is the highest at IAD airport and lowest at ATL airport getting as low as 10% chance.\n\n::: {#72a84179 .cell execution_count=9}\n``` {.python .cell-code}\ndf4bar = df4.groupby('airport_code').agg(\n  total_flights = ('num_of_flights_total', 'sum'),\n  total_delayed_flights = ('total_weather_delay', 'sum'),\n  num_of_delays_carrier = (\"num_of_delays_carrier\", 'sum'),\n  num_of_delays_security = (\"num_of_delays_security\", 'sum'),\n).reset_index()\n\ndf4bar['prop_of_delays_weather'] = round(df4bar['total_delayed_flights'] / df4bar['total_flights'],2)\ndf4bar['prop_of_delays_carrier'] = round(df4bar['num_of_delays_carrier'] / df4bar['total_flights'],2)\ndf4bar['prop_of_delays_security'] = round(df4bar['num_of_delays_security'] / df4bar['total_flights'],2)\n\n\n\n\ndf4bar\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>airport_code</th>\n      <th>total_flights</th>\n      <th>total_delayed_flights</th>\n      <th>num_of_delays_carrier</th>\n      <th>num_of_delays_security</th>\n      <th>prop_of_delays_weather</th>\n      <th>prop_of_delays_carrier</th>\n      <th>prop_of_delays_security</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>ATL</td>\n      <td>4430047</td>\n      <td>450637.470588</td>\n      <td>173075</td>\n      <td>833</td>\n      <td>0.10</td>\n      <td>0.04</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>DEN</td>\n      <td>2513974</td>\n      <td>378356.500000</td>\n      <td>121885</td>\n      <td>985</td>\n      <td>0.15</td>\n      <td>0.05</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>IAD</td>\n      <td>851571</td>\n      <td>228643.300000</td>\n      <td>47761</td>\n      <td>272</td>\n      <td>0.27</td>\n      <td>0.06</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>ORD</td>\n      <td>3597588</td>\n      <td>495550.741176</td>\n      <td>146491</td>\n      <td>862</td>\n      <td>0.14</td>\n      <td>0.04</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>SAN</td>\n      <td>917862</td>\n      <td>236136.500000</td>\n      <td>57130</td>\n      <td>490</td>\n      <td>0.26</td>\n      <td>0.06</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>SFO</td>\n      <td>1630945</td>\n      <td>305776.200000</td>\n      <td>86417</td>\n      <td>697</td>\n      <td>0.19</td>\n      <td>0.05</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>SLC</td>\n      <td>1403384</td>\n      <td>247641.500000</td>\n      <td>65033</td>\n      <td>867</td>\n      <td>0.18</td>\n      <td>0.05</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#7790c95f .cell execution_count=10}\n``` {.python .cell-code}\np = (ggplot(df4bar, aes(x='airport_code', y='prop_of_delays_weather', )) +\n  geom_bar(stat = 'identity', color = 'black', fill = 'white', width = .85) +\n  xlab('airport_code') +\n  ylab('% of Flights Delayed') +\n  labs(\n    title=\"Chance of Experiencing Any Delay by Airport\"\n  )+\n  theme_classic() +\n  theme(\n    axis_text_y= element_text(),\n    plot_title= element_text(angle=90, size=20),\n    panel_background= element_rect(fill = \"gray\")\n  )\n\n)\np.show()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<html lang=\"en\">\n   <head>\n       <meta charset=\"UTF-8\">\n       <style> html, body { margin: 0; padding: 0; } </style>\n       <script type=\"text/javascript\" data-lets-plot-script=\"library\" src=\"https://cdn.jsdelivr.net/gh/JetBrains/lets-plot@v4.6.2/js-package/distr/lets-plot.min.js\"></script>\n   </head>\n   <body>\n          <div id=\"vkTOKq\"></div>\n   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n   \n   (function() {\n   // ----------\n   \n   const forceImmediateRender = false;\n   const responsive = false;\n   \n   let sizing = {\n       width_mode: \"MIN\",\n       height_mode: \"SCALED\",\n       width: null, \n       height: null \n   };\n   \n   const preferredWidth = document.body.dataset.letsPlotPreferredWidth;\n   if (preferredWidth !== undefined) {\n       sizing = {\n           width_mode: 'FIXED',\n           height_mode: 'SCALED',\n           width: parseFloat(preferredWidth)\n       };\n   }\n   \n   const containerDiv = document.getElementById(\"vkTOKq\");\n   let fig = null;\n   \n   function renderPlot() {\n       if (fig === null) {\n           const plotSpec = {\n\"data\":{\n\"airport_code\":[\"ATL\",\"DEN\",\"IAD\",\"ORD\",\"SAN\",\"SFO\",\"SLC\"],\n\"prop_of_delays_weather\":[0.1,0.15,0.27,0.14,0.26,0.19,0.18]\n},\n\"mapping\":{\n\"x\":\"airport_code\",\n\"y\":\"prop_of_delays_weather\"\n},\n\"data_meta\":{\n\"series_annotations\":[{\n\"type\":\"str\",\n\"column\":\"airport_code\"\n},{\n\"type\":\"int\",\n\"column\":\"total_flights\"\n},{\n\"type\":\"float\",\n\"column\":\"total_delayed_flights\"\n},{\n\"type\":\"int\",\n\"column\":\"num_of_delays_carrier\"\n},{\n\"type\":\"int\",\n\"column\":\"num_of_delays_security\"\n},{\n\"type\":\"float\",\n\"column\":\"prop_of_delays_weather\"\n},{\n\"type\":\"float\",\n\"column\":\"prop_of_delays_carrier\"\n},{\n\"type\":\"float\",\n\"column\":\"prop_of_delays_security\"\n}]\n},\n\"guides\":{\n\"x\":{\n\"title\":\"airport_code\"\n},\n\"y\":{\n\"title\":\"% of Flights Delayed\"\n}\n},\n\"ggtitle\":{\n\"text\":\"Chance of Experiencing Any Delay by Airport\"\n},\n\"theme\":{\n\"name\":\"classic\",\n\"axis_text_y\":{\n\"blank\":false\n},\n\"panel_background\":{\n\"fill\":\"gray\",\n\"blank\":false\n},\n\"plot_title\":{\n\"size\":20.0,\n\"angle\":90.0,\n\"blank\":false\n}\n},\n\"kind\":\"plot\",\n\"scales\":[],\n\"layers\":[{\n\"geom\":\"bar\",\n\"stat\":\"identity\",\n\"mapping\":{\n},\n\"data_meta\":{\n},\n\"color\":\"black\",\n\"fill\":\"white\",\n\"width\":0.85,\n\"data\":{\n}\n}],\n\"metainfo_list\":[],\n\"spec_id\":\"2\"\n};\n           fig = LetsPlot.buildPlotFromProcessedSpecs(plotSpec, containerDiv, sizing);\n       } else {\n           fig.updateView({});\n       }\n   }\n   \n   const renderImmediately = \n       forceImmediateRender || (\n           sizing.width_mode === 'FIXED' && \n           (sizing.height_mode === 'FIXED' || sizing.height_mode === 'SCALED')\n       );\n   \n   if (renderImmediately) {\n       renderPlot();\n   }\n   \n   if (!renderImmediately || responsive) {\n       // Set up observer for initial sizing or continuous monitoring\n       var observer = new ResizeObserver(function(entries) {\n           for (let entry of entries) {\n               if (entry.contentBoxSize && \n                   entry.contentBoxSize[0].inlineSize > 0) {\n                   if (!responsive && observer) {\n                       observer.disconnect();\n                       observer = null;\n                   }\n                   renderPlot();\n                   if (!responsive) {\n                       break;\n                   }\n               }\n           }\n       });\n       \n       observer.observe(containerDiv);\n   }\n   \n   // ----------\n   })();\n   \n   </script>\n   </body>\n</html>\n```\n:::\n:::\n\n\n---\n\n\n## STRETCH QUESTION|TASK 1\n\n__Which delay is the worst delay?__ Create a similar analysis as above for Weahter Delay with: Carrier Delay and Security Delay. Compare the proportion of delay for each of the three categories in a Chart and a Table. Describe your results.\n\nThe following shows the delays but all types are separated into the categories weather, carrier, and security. We can see that carrier delays are highest in IAD and SAN airports. And the highest chance of encountering a delay from weather is also IAD and SAN.\n\n::: {#291baa8a .cell execution_count=11}\n``` {.python .cell-code}\ndf5 = pd.melt(\n  df4bar,\n  id_vars= 'airport_code',\n  value_vars=  ['prop_of_delays_weather', 'prop_of_delays_carrier', 'prop_of_delays_security'],\n  var_name= 'delay_type', \n  value_name= 'proportion'\n)\n\np = (\n    ggplot(\n        df5,\n        aes(x='airport_code',\n            y='proportion',\n            fill='delay_type')          # <─ aesthetic mapping goes here\n    )\n    + geom_bar(\n        stat='identity',\n        colour='black',\n        width=.85,\n        position='dodge'               # side-by-side bars by delay type\n    )\n    + xlab('Airport Code')\n    + ylab('Proportion of Flights Delayed')\n    + ggtitle('Chance of Experiencing Any Delay by Airport')\n    + theme_classic()\n    + theme(\n        axis_text_x=element_text(angle=45, hjust=1),  # tilt if labels overlap\n        plot_title=element_text(size=20),\n        panel_background=element_rect(fill=\"gray\")\n    )\n)\n\np.show()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<html lang=\"en\">\n   <head>\n       <meta charset=\"UTF-8\">\n       <style> html, body { margin: 0; padding: 0; } </style>\n       <script type=\"text/javascript\" data-lets-plot-script=\"library\" src=\"https://cdn.jsdelivr.net/gh/JetBrains/lets-plot@v4.6.2/js-package/distr/lets-plot.min.js\"></script>\n   </head>\n   <body>\n          <div id=\"DFZNg1\"></div>\n   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n   \n   (function() {\n   // ----------\n   \n   const forceImmediateRender = false;\n   const responsive = false;\n   \n   let sizing = {\n       width_mode: \"MIN\",\n       height_mode: \"SCALED\",\n       width: null, \n       height: null \n   };\n   \n   const preferredWidth = document.body.dataset.letsPlotPreferredWidth;\n   if (preferredWidth !== undefined) {\n       sizing = {\n           width_mode: 'FIXED',\n           height_mode: 'SCALED',\n           width: parseFloat(preferredWidth)\n       };\n   }\n   \n   const containerDiv = document.getElementById(\"DFZNg1\");\n   let fig = null;\n   \n   function renderPlot() {\n       if (fig === null) {\n           const plotSpec = {\n\"data\":{\n\"airport_code\":[\"ATL\",\"DEN\",\"IAD\",\"ORD\",\"SAN\",\"SFO\",\"SLC\",\"ATL\",\"DEN\",\"IAD\",\"ORD\",\"SAN\",\"SFO\",\"SLC\",\"ATL\",\"DEN\",\"IAD\",\"ORD\",\"SAN\",\"SFO\",\"SLC\"],\n\"delay_type\":[\"prop_of_delays_weather\",\"prop_of_delays_weather\",\"prop_of_delays_weather\",\"prop_of_delays_weather\",\"prop_of_delays_weather\",\"prop_of_delays_weather\",\"prop_of_delays_weather\",\"prop_of_delays_carrier\",\"prop_of_delays_carrier\",\"prop_of_delays_carrier\",\"prop_of_delays_carrier\",\"prop_of_delays_carrier\",\"prop_of_delays_carrier\",\"prop_of_delays_carrier\",\"prop_of_delays_security\",\"prop_of_delays_security\",\"prop_of_delays_security\",\"prop_of_delays_security\",\"prop_of_delays_security\",\"prop_of_delays_security\",\"prop_of_delays_security\"],\n\"proportion\":[0.1,0.15,0.27,0.14,0.26,0.19,0.18,0.04,0.05,0.06,0.04,0.06,0.05,0.05,0.0,0.0,0.0,0.0,0.0,0.0,0.0]\n},\n\"mapping\":{\n\"x\":\"airport_code\",\n\"y\":\"proportion\",\n\"fill\":\"delay_type\"\n},\n\"data_meta\":{\n\"series_annotations\":[{\n\"type\":\"str\",\n\"column\":\"airport_code\"\n},{\n\"type\":\"str\",\n\"column\":\"delay_type\"\n},{\n\"type\":\"float\",\n\"column\":\"proportion\"\n}]\n},\n\"guides\":{\n\"x\":{\n\"title\":\"Airport Code\"\n},\n\"y\":{\n\"title\":\"Proportion of Flights Delayed\"\n}\n},\n\"ggtitle\":{\n\"text\":\"Chance of Experiencing Any Delay by Airport\"\n},\n\"theme\":{\n\"name\":\"classic\",\n\"axis_text_x\":{\n\"angle\":45.0,\n\"hjust\":1.0,\n\"blank\":false\n},\n\"panel_background\":{\n\"fill\":\"gray\",\n\"blank\":false\n},\n\"plot_title\":{\n\"size\":20.0,\n\"blank\":false\n}\n},\n\"kind\":\"plot\",\n\"scales\":[],\n\"layers\":[{\n\"geom\":\"bar\",\n\"stat\":\"identity\",\n\"mapping\":{\n},\n\"position\":\"dodge\",\n\"data_meta\":{\n},\n\"colour\":\"black\",\n\"width\":0.85,\n\"data\":{\n}\n}],\n\"metainfo_list\":[],\n\"spec_id\":\"3\"\n};\n           fig = LetsPlot.buildPlotFromProcessedSpecs(plotSpec, containerDiv, sizing);\n       } else {\n           fig.updateView({});\n       }\n   }\n   \n   const renderImmediately = \n       forceImmediateRender || (\n           sizing.width_mode === 'FIXED' && \n           (sizing.height_mode === 'FIXED' || sizing.height_mode === 'SCALED')\n       );\n   \n   if (renderImmediately) {\n       renderPlot();\n   }\n   \n   if (!renderImmediately || responsive) {\n       // Set up observer for initial sizing or continuous monitoring\n       var observer = new ResizeObserver(function(entries) {\n           for (let entry of entries) {\n               if (entry.contentBoxSize && \n                   entry.contentBoxSize[0].inlineSize > 0) {\n                   if (!responsive && observer) {\n                       observer.disconnect();\n                       observer = null;\n                   }\n                   renderPlot();\n                   if (!responsive) {\n                       break;\n                   }\n               }\n           }\n       });\n       \n       observer.observe(containerDiv);\n   }\n   \n   // ----------\n   })();\n   \n   </script>\n   </body>\n</html>\n```\n:::\n:::\n\n\n---\n\n\n<!-- C:\\Users\\tanne\\OneDrive\\Documents\\GitHub\\Tanner_Hamblin_spr25\\250_Projects\\project4.qmd -->\n\n",
    "supporting": [
      "project3_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}